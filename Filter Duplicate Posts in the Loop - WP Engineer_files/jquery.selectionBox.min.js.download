;(function($,window,undefined){var selectionBox='selectionBox',document=window.document,defaults={selectContainerClass:'selection-box',optionsContainerClass:'selection-box-options',optionContainerClass:'selection-box-option',selectedOptionClass:'selection-box-selected',currentContainerClass:'selection-box-current',defaultText:'---'};function SelectionBox(element,options){this.element=element;this.$el=$(element);this.state=false;this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=selectionBox;this.init();}
SelectionBox.prototype={init:function(){this.wrapElement().hideSelectElement().attachCurrentContainer().setDefaultText().attachList().populateList().hideList().bind();},setCurrentContainerText:function(text){this.$current.text(text);},toggleSelectedOption:function(i){if(this.$options.children('.'+this.options.selectedOptionClass).length>0){this.$options.children('.'+this.options.selectedOptionClass).removeClass(options.selectedOptionClass);}
if(this.$options.children(':selected').length>0){this.$options.children(':selected').attr('selected',false);}
this.$options.children().eq(i).addClass(this.options.selectedOptionClass);},selectOption:function(i){this.$el.children().eq(i).attr('selected',true);this.$el.trigger('change');},showList:function(){this.state=true;this.$options.css('display','block');},wrapElement:function(){this.$el.wrap('<div class='+this.options.selectContainerClass+' />');this.$selectionBox=this.$el.parents('.'+this.options.selectContainerClass);return this;},hideSelectElement:function(){this.$el.css('display','none');return this;},attachCurrentContainer:function(){this.$selectionBox.append('<div class="'+this.options.currentContainerClass+'" />');this.$current=this.$selectionBox.find('.'+this.options.currentContainerClass);return this;},setDefaultText:function(){var options=this.options;this.$el.find('option').each(function(i,el){if(el.selected){options.defaultText=$(el).text();}});if(this.options.defaultText=='---'){this.options.defaultText=this.element[0].innerHTML;}
this.$current.text(this.options.defaultText);return this;},attachList:function(){this.$selectionBox.append('<ul class="'+this.options.optionsContainerClass+'" />');this.$options=this.$selectionBox.find('.'+this.options.optionsContainerClass);return this;},populateList:function(){var selectionBox=this.$selectionBox,options=this.options,text,listItem;this.$el.find('option').each(function(i,el){text=$(el).text();var hiddenClass='';if(text==options.defaultText){hiddenClass=' visually-hidden';}
listItem='<li class="'+options.optionContainerClass+hiddenClass+'">'+text+'</li>';selectionBox.find('.'+options.optionsContainerClass).append(listItem);});return this;},hideList:function(){this.state=false;this.$options.css('display','none');return this;},bind:function(){var self=this;this.$selectionBox.on('click.toggleOptions',function(e){if(!self.state){self.showList();}else{self.hideList();}});this.$options.children().on('click.selectOption',function(e){e.stopPropagation();var i=$(this).index(),text=$(this).text();self.selectOption(i);self.toggleSelectedOption(i);self.setCurrentContainerText(text);self.hideList();});}};$.fn[selectionBox]=function(options){return this.each(function(){if(!$.data(this,'plugin_'+selectionBox)){$.data(this,'plugin_'+selectionBox,new SelectionBox(this,options));}});};}(jQuery,window));